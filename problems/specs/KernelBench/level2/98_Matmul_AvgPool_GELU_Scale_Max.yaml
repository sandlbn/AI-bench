inputs:
  X:
    shape: [BATCH, IN_FEAT]
    dtype: float16

inits:
  - dim: IN_FEAT
  - dim: OUT_FEAT
  - dim: POOL_KERNEL_SIZE
  - dim: SCALE

ci:
  - params: [X]
    dtype: float16
    dims:
      BATCH: 32
      IN_FEAT: 128
      OUT_FEAT: 128
      POOL_KERNEL_SIZE: 16
      SCALE: 2.0
    flop: "BATCH*IN_FEAT*(POOL_KERNEL_SIZE-1) + 2*BATCH*OUT_FEAT*IN_FEAT + BATCH*OUT_FEAT"

bench-gpu:
  - params: [X]
    dtype: float16
    dims:
      BATCH: 1024
      IN_FEAT: 4096
      OUT_FEAT: 4096
      POOL_KERNEL_SIZE: 16
      SCALE: 2.0
    flop: "BATCH*IN_FEAT*(POOL_KERNEL_SIZE-1) + 2*BATCH*OUT_FEAT*IN_FEAT + BATCH*OUT_FEAT"
